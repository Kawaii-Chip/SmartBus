
TIM2 PA0
TIM3  -systick
TIM4 PB6
串口1快速中断 A9 10 debug onenet
串口2快速中断 A2 3 nfc
串口3快速中断 B10 11 9600 audio
串口6快速中断 
串口8快速中断 C4 5 9600 gps

A1 A4 key

DH11
    DATA B12

LCD
    SCL	PB3
    SDA	PB5
    RES	NRST
    DC	PD3
    CS	PD4 
    BL	PD5

eeprom
    SCL PE6
    SDA PE5

SD
 *   DVP--PIN:
 *   D0--PC8
 *   D1--PC9
 *   D2--PC10
 *   D3--PC11
 *   SCK--PC12
 *   CMD--PD2

audio
    30 欢迎上车
    31 第一站
    32 第二站
    33 第3站
    34 第4站
    35 第5站
    36 第6站
    37 第7站
   
    40 有乘客请求上车
    50 已到达，下一站是
    60 请刷入要添加的乘车卡
    61 未能识别通勤卡
    62 添加成功，目的地
    71 风扇已打开
    72 风扇已关闭
    73 灯光已打开
    74 灯光已关闭
    75 有乘客晕车，请求降低车速
    76 有乘客着急，请求加速
   

注册乘客（更改目的地）：//app发送请求到单片机，单片机储存到eeprom，单片机每次开机读取
    1.卡号
    2.目的地

乘客上车app://app发送上车请求，单片机回应收到
    1.乘客站点名称（用手机app定位实现）
    

乘客上车刷卡：//单片机链表储存每日总数据（掉电消失），app管理员可获取数据
    1.上车时间
    2.目的地
    3.人数

客车：//单片机每秒发送一次经纬度与前往站点，app处理经纬度生成位置和地图路线（高德地图有API，确定两点可以按照地图生成导航）
    1.经度
    2.纬度
    3.当前前往站点（我用一个链表把所有站点排好了，要是下一个站点没有下车请求或上车请求会向下遍历站点）
   
车辆行驶中：//
    1.温度，湿度（单片机发送温度，湿度，乘客可以app查看）
    2.乘客通过app发送对空调，车速等要求，单片机接收


综上，onenet变量是
    1.一个数组 储存卡号，目的地
    2.一个数组 储存经度纬度和下一站
    3.一个数组 储存每日数据（上车时间，目的地，总人数）
    4.一个数组 储存温度，湿度
    5.一个字符串 储存乘客app发送上车请求的位置
    6.一个字符串 储存乘客对车速等的要求
    7.一个char 储存请求类型（1~6）
    

模块
    audio       语音播报 （只能播报设定好的音频，不能自动生成）
    eeprom      掉电储存乘客的卡号和目的地信息
    gps         轮询的方式提供当前的lat lon 下一站
    lcd         没设计图片页面呢
    nfc         上车刷卡，注册刷卡
    esp8266     连接onenet平台
    DTH11       温度湿度测量

onenet变量
    appkey      发送指令号，单片机识别进行对应指令的解析
    DTH11       数组类型，传递温度，湿度
    address     ,  传递lat lon 下一站
    advice      string,  传递乘客的建议编号(对接语音编号)
    data        数组，    第一位是资料类型（1：路程客流量，2：时间段客流量） 如[1,2,5,10]表示2站到5站一共10人
                                                                            [2,4,20]表示4点到5点一共20人打车
   
    passenger       在管理员注册（或更改）时对单片机发送目的地并将车卡刷入单片机系统
                                    （为什么这样麻烦，因为我发现string传不了hex，而车卡用hex识别，如果能解决就直接发卡号）

    quest            传递乘客上车的位置，发送打车请求


主要功能
    车按照设定的车站顺序遍历，如果下一站没有乘客上车或下车，则抄近道遍历下下个（链表）
    乘客app发送打车请求（包含乘客的位置），然后上车刷卡，单片机将信息写入data链表
    app可以读出当天的data汇总，掉电消失
    单片机轮询发送经纬度和下一站到app，app可以连连看(高德API更好)
    温度，湿度同理
    app可以发送乘客建议（如空调过冷），单片机接收并语音播报（只能按照写好的语音，不能临时生成，因为没有ai模块）
    gps定位扫描位置，状态原理，如果经纬度接近站点，就分到站，等待，出站


介绍核心功能 规划路线，语音播报，SD储存乘客行程日报表，内置al辅助，优化乘客体验

验证核心功能
介绍touchkey
手动报站
介绍时钟，人数，温度湿度，同步显示到app 
介绍app
刷入车卡 2站 7站
说明路线规划
请求上车 3站 5站
驶向下一站
说明路线规划，人数
驶向下一站
说明路线规划，人数
驶向下一站
说明路线规划
驶向下一站
无任务按顺序行驶

验证SD卡功能
拿下SD卡展示无内容
生成日报表
拿下SD卡展示有内容 乘客的时间段，统计数据分析客流量

展示蓝牙无线连接
验证al功能
睡觉
暗
车快
车满
太冷了
太热了

验证gps功能
选择自动报站
请求上车 2 4
验证到站
展示下一站的规划





